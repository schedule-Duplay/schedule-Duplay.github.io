<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulator Daftar Isi Otomatis MS Word Lengkap</title>
    <style>
        :root {
            --primary: #2B579A;
            --secondary: #D83B01;
            --light: #F5F5F5;
            --dark: #323130;
            --success: #107C10;
            --warning: #FFB900;
            --gray: #8A8886;
            --toolbar-bg: #F3F3F3;
            --ribbon-bg: #FFFFFF;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: var(--dark);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), #1e4e8c);
            color: white;
            padding: 25px 0;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        header h1 {
            font-size: 2.4rem;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        header p {
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
            opacity: 0.9;
        }
        
        .word-container {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        /* Toolbar Atas */
        .word-toolbar {
            background: var(--toolbar-bg);
            padding: 8px 15px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .file-menu {
            display: flex;
            gap: 15px;
        }
        
        .file-menu button {
            background: none;
            border: none;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .file-menu button:hover {
            background: rgba(0,0,0,0.05);
        }
        
        .quick-access {
            display: flex;
            gap: 10px;
        }
        
        .quick-access button {
            background: none;
            border: none;
            padding: 6px 10px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        /* Ribbon */
        .ribbon {
            background: var(--ribbon-bg);
            padding: 10px 15px;
            border-bottom: 1px solid #ddd;
            display: flex;
            gap: 25px;
        }
        
        .ribbon-tab {
            display: flex;
            gap: 15px;
        }
        
        .ribbon-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .ribbon-group-title {
            font-size: 0.75rem;
            color: var(--gray);
            text-align: center;
        }
        
        .ribbon-buttons {
            display: flex;
            gap: 5px;
        }
        
        .ribbon-button {
            background: none;
            border: none;
            padding: 8px;
            cursor: pointer;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            font-size: 0.8rem;
            min-width: 60px;
        }
        
        .ribbon-button:hover {
            background: rgba(0,0,0,0.05);
        }
        
        .ribbon-button.active {
            background: rgba(43, 87, 154, 0.1);
            color: var(--primary);
        }
        
        .ribbon-button i {
            font-size: 1.2rem;
        }
        
        /* Area Kerja */
        .workspace {
            display: grid;
            grid-template-columns: 1fr 350px;
            min-height: 600px;
        }
        
        @media (max-width: 1024px) {
            .workspace {
                grid-template-columns: 1fr;
            }
        }
        
        .document-panel {
            padding: 25px;
            background: white;
            border-right: 1px solid #eee;
            overflow-y: auto;
        }
        
        .sidebar-panel {
            padding: 20px;
            background: #f9f9f9;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* Style untuk dokumen */
        .document-content {
            min-height: 500px;
            padding: 20px;
            border: 1px solid #e1e5e9;
            border-radius: 4px;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .page {
            background: white;
            min-height: 400px;
            padding: 40px 50px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            margin: 0 auto;
            max-width: 800px;
            position: relative;
        }
        
        .page::after {
            content: "";
            position: absolute;
            bottom: 10px;
            right: 10px;
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        .heading-1 {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2c3e50;
            margin: 20px 0 10px;
            padding: 5px 0;
        }
        
        .heading-2 {
            font-size: 1.5rem;
            font-weight: bold;
            color: #34495e;
            margin: 15px 0 8px;
            margin-left: 15px;
            padding: 4px 0;
        }
        
        .heading-3 {
            font-size: 1.3rem;
            font-weight: bold;
            color: #5d6d7e;
            margin: 12px 0 6px;
            margin-left: 30px;
            padding: 3px 0;
        }
        
        .normal-text {
            margin: 8px 0;
            padding: 2px 0;
            line-height: 1.6;
        }
        
        .selected {
            background-color: #e6f3ff !important;
            outline: 2px solid var(--primary);
        }
        
        /* Sidebar Components */
        .sidebar-section {
            background: white;
            border-radius: 6px;
            padding: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .sidebar-title {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee;
        }
        
        .style-gallery {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin: 10px 0;
        }
        
        .style-button {
            padding: 8px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            background: white;
            transition: all 0.2s;
            text-align: left;
            font-size: 0.9rem;
        }
        
        .style-button:hover {
            background: #f0f0f0;
        }
        
        .style-button.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .toc-preview {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            background: white;
            margin-top: 10px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .toc-item {
            margin: 6px 0;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 3px;
            transition: background-color 0.2s;
            display: flex;
            justify-content: space-between;
        }
        
        .toc-item:hover {
            background-color: #f0f8ff;
        }
        
        .toc-h1 {
            font-weight: bold;
            margin-left: 0;
            font-size: 1rem;
        }
        
        .toc-h2 {
            margin-left: 15px;
            font-size: 0.95rem;
        }
        
        .toc-h3 {
            margin-left: 30px;
            font-size: 0.9rem;
        }
        
        .page-number {
            color: var(--gray);
        }
        
        /* Panel Navigasi */
        .navigation-panel {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .nav-button {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }
        
        .nav-button:hover {
            background: #f0f0f0;
        }
        
        .nav-button.primary {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .nav-button.primary:hover {
            background: #1e4e8c;
        }
        
        /* Panel Informasi */
        .info-panel {
            margin-top: 20px;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .info-label {
            font-weight: 500;
            color: var(--gray);
        }
        
        .info-value {
            font-weight: 600;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 8px;
            padding: 25px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary);
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }
        
        .close-modal:hover {
            color: var(--dark);
        }
        
        /* Footer */
        .word-status-bar {
            background: var(--toolbar-bg);
            padding: 8px 15px;
            border-top: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: var(--gray);
        }
        
        .status-left, .status-right {
            display: flex;
            gap: 20px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: var(--gray);
            border-top: 1px solid #e1e5e9;
            font-size: 0.9rem;
        }
        
        /* Responsif */
        @media (max-width: 768px) {
            .ribbon {
                flex-direction: column;
                gap: 15px;
            }
            
            .workspace {
                grid-template-columns: 1fr;
            }
            
            .document-panel {
                border-right: none;
                border-bottom: 1px solid #eee;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Simulator Daftar Isi Otomatis MS Word</h1>
            <p>Praktek Lengkap Pembuatan Daftar Isi Otomatis dengan Simulator Microsoft Word</p>
        </header>
        
        <div class="word-container">
            <!-- Toolbar Atas -->
            <div class="word-toolbar">
                <div class="file-menu">
                    <button>File</button>
                    <button>Edit</button>
                    <button>View</button>
                    <button>Insert</button>
                    <button class="active">Format</button>
                    <button>Tools</button>
                    <button>Table</button>
                    <button>Window</button>
                    <button>Help</button>
                </div>
                <div class="quick-access">
                    <button><i class="fas fa-save"></i></button>
                    <button><i class="fas fa-undo"></i></button>
                    <button><i class="fas fa-redo"></i></button>
                    <button><i class="fas fa-print"></i></button>
                </div>
            </div>
            
            <!-- Ribbon -->
            <div class="ribbon">
                <div class="ribbon-tab">
                    <div class="ribbon-group">
                        <div class="ribbon-group-title">Font</div>
                        <div class="ribbon-buttons">
                            <button class="ribbon-button" title="Bold"><i class="fas fa-bold"></i></button>
                            <button class="ribbon-button" title="Italic"><i class="fas fa-italic"></i></button>
                            <button class="ribbon-button" title="Underline"><i class="fas fa-underline"></i></button>
                        </div>
                    </div>
                    
                    <div class="ribbon-group">
                        <div class="ribbon-group-title">Paragraph</div>
                        <div class="ribbon-buttons">
                            <button class="ribbon-button" title="Bullet List"><i class="fas fa-list-ul"></i></button>
                            <button class="ribbon-button" title="Numbering"><i class="fas fa-list-ol"></i></button>
                            <button class="ribbon-button" title="Decrease Indent"><i class="fas fa-outdent"></i></button>
                            <button class="ribbon-button" title="Increase Indent"><i class="fas fa-indent"></i></button>
                        </div>
                    </div>
                    
                    <div class="ribbon-group">
                        <div class="ribbon-group-title">Styles</div>
                        <div class="ribbon-buttons">
                            <button class="ribbon-button active" onclick="showStylesPanel()" title="Styles"><i class="fas fa-paint-brush"></i><span>Styles</span></button>
                        </div>
                    </div>
                </div>
                
                <div class="ribbon-tab">
                    <div class="ribbon-group">
                        <div class="ribbon-group-title">References</div>
                        <div class="ribbon-buttons">
                            <button class="ribbon-button" onclick="showTOCPanel()" title="Table of Contents"><i class="fas fa-list"></i><span>Daftar Isi</span></button>
                            <button class="ribbon-button" title="Insert Footnote"><i class="fas fa-bookmark"></i><span>Catatan Kaki</span></button>
                            <button class="ribbon-button" title="Citations"><i class="fas fa-quote-right"></i><span>Kutipan</span></button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Area Kerja -->
            <div class="workspace">
                <div class="document-panel">
                    <div class="document-content">
                        <div class="page" id="documentPage">
                            <div class="heading-1" data-heading="1">LAPORAN KEGIATAN OSIS SMA NEGERI 2 PLAYEN</div>
                            <div class="normal-text" data-heading="0" style="text-align: center;">Tahun Pelajaran 2024/2025</div>
                            
                            <div class="heading-1" data-heading="1">BAB I PENDAHULUAN</div>
                            <div class="heading-2" data-heading="2">1.1 Latar Belakang</div>
                            <div class="normal-text" data-heading="0">OSIS SMA Negeri 2 Playen memiliki tanggung jawab sosial untuk menumbuhkan rasa kepedulian terhadap masyarakat sekitar. Salah satu bentuk kegiatan yang dilakukan setiap tahun adalah kegiatan bakti sosial dan donor darah. Kegiatan ini diadakan bekerja sama dengan Palang Merah Indonesia (PMI) Kabupaten Gunungkidul.</div>
                            
                            <div class="heading-2" data-heading="2">1.2 Tujuan Kegiatan</div>
                            <div class="normal-text" data-heading="0">Kegiatan ini bertujuan untuk:</div>
                            <div class="normal-text" data-heading="0">1. Menumbuhkan rasa empati dan kepedulian sosial siswa.</div>
                            <div class="normal-text" data-heading="0">2. Meningkatkan kesadaran pentingnya donor darah bagi kesehatan masyarakat.</div>
                            <div class="normal-text" data-heading="0">3. Membangun citra positif sekolah melalui kegiatan sosial kemanusiaan.</div>
                            
                            <div class="heading-1" data-heading="1">BAB II PELAKSANAAN KEGIATAN</div>
                            <div class="heading-2" data-heading="2">2.1 Waktu dan Tempat Pelaksanaan</div>
                            <div class="normal-text" data-heading="0">Kegiatan dilaksanakan pada hari Jumat, 14 Februari 2025, pukul 07.30â€“12.00 WIB di Aula SMA Negeri 2 Playen.</div>
                            
                            <div class="heading-2" data-heading="2">2.2 Peserta Kegiatan</div>
                            <div class="normal-text" data-heading="0">Peserta kegiatan terdiri dari seluruh pengurus OSIS, anggota ekstrakurikuler PMR, serta guru pendamping.</div>
                            
                            <div class="heading-2" data-heading="2">2.3 Rangkaian Acara</div>
                            <div class="normal-text" data-heading="0">1. Pembukaan dan sambutan Kepala Sekolah</div>
                            <div class="normal-text" data-heading="0">2. Penyuluhan tentang pentingnya donor darah</div>
                            <div class="normal-text" data-heading="0">3. Donor darah bersama PMI</div>
                            <div class="normal-text" data-heading="0">4. Penyerahan bantuan sosial kepada masyarakat sekitar</div>
                            <div class="normal-text" data-heading="0">5. Penutupan</div>
                            
                            <div class="heading-1" data-heading="1">BAB III HASIL DAN PEMBAHASAN</div>
                            <div class="heading-2" data-heading="2">3.1 Hasil Pelaksanaan Kegiatan</div>
                            <div class="normal-text" data-heading="0">Dari kegiatan donor darah, terkumpul sebanyak 67 kantong darah yang diserahkan kepada PMI Gunungkidul. Selain itu, bantuan sosial berupa paket sembako sebanyak 80 paket disalurkan ke warga sekitar sekolah.</div>
                            
                            <div class="heading-2" data-heading="2">3.2 Evaluasi Kegiatan</div>
                            <div class="normal-text" data-heading="0">Secara umum kegiatan berjalan lancar. Namun, beberapa kendala ditemukan, antara lain kurangnya alat medis dari PMI dan keterbatasan waktu pelaksanaan.</div>
                            
                            <div class="heading-1" data-heading="1">BAB IV PENUTUP</div>
                            <div class="heading-2" data-heading="2">4.1 Kesimpulan</div>
                            <div class="normal-text" data-heading="0">Kegiatan bakti sosial dan donor darah ini memberikan manfaat besar bagi masyarakat dan siswa. Melalui kegiatan ini, siswa belajar untuk berempati, bekerja sama, dan menumbuhkan semangat gotong royong.</div>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-panel">
                    <!-- Panel Styles -->
                    <div class="sidebar-section">
                        <div class="sidebar-title">Styles</div>
                        <div class="style-gallery">
                            <button class="style-button" onclick="applyStyle('normal')">
                                <div style="font-weight: normal;">Normal</div>
                                <div style="font-size: 0.8rem; color: #666;">Body text</div>
                            </button>
                            <button class="style-button" onclick="applyStyle('heading-1')">
                                <div style="font-weight: bold; font-size: 1.1rem;">Heading 1</div>
                                <div style="font-size: 0.8rem; color: #666;">Bab utama</div>
                            </button>
                            <button class="style-button" onclick="applyStyle('heading-2')">
                                <div style="font-weight: bold; font-size: 1rem;">Heading 2</div>
                                <div style="font-size: 0.8rem; color: #666;">Sub-bab</div>
                            </button>
                            <button class="style-button" onclick="applyStyle('heading-3')">
                                <div style="font-weight: bold; font-size: 0.95rem;">Heading 3</div>
                                <div style="font-size: 0.8rem; color: #666;">Sub-sub-bab</div>
                            </button>
                        </div>
                        
                        <div class="navigation-panel">
                            <button class="nav-button" onclick="showStylesModal()">
                                <i class="fas fa-expand"></i> Panel Styles Lengkap
                            </button>
                        </div>
                    </div>
                    
                    <!-- Panel Daftar Isi -->
                    <div class="sidebar-section">
                        <div class="sidebar-title">Daftar Isi</div>
                        <div class="toc-preview" id="tocPreview">
                            <p>Pratinjau daftar isi akan muncul di sini setelah Anda menerapkan heading styles dan mengklik "Buat Daftar Isi".</p>
                        </div>
                        
                        <div class="navigation-panel">
                            <button class="nav-button" onclick="updateTOC()">
                                <i class="fas fa-sync"></i> Perbarui
                            </button>
                            <button class="nav-button primary" onclick="generateTOC()">
                                <i class="fas fa-magic"></i> Buat Daftar Isi
                            </button>
                        </div>
                    </div>
                    
                    <!-- Panel Informasi -->
                    <div class="sidebar-section info-panel">
                        <div class="sidebar-title">Informasi Dokumen</div>
                        <div class="info-item">
                            <span class="info-label">Jumlah Heading 1:</span>
                            <span class="info-value" id="heading1Count">4</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Jumlah Heading 2:</span>
                            <span class="info-value" id="heading2Count">8</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Jumlah Heading 3:</span>
                            <span class="info-value" id="heading3Count">0</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Status Daftar Isi:</span>
                            <span class="info-value" id="tocStatus">Belum Dibuat</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Status Bar -->
            <div class="word-status-bar">
                <div class="status-left">
                    <span>Halaman 1 dari 1</span>
                    <span>Kata: 427</span>
                </div>
                <div class="status-right">
                    <span>Bahasa Indonesia</span>
                    <span><i class="fas fa-eye"></i> 100%</span>
                </div>
            </div>
        </div>
        
        <!-- Modal Styles Lengkap -->
        <div class="modal" id="stylesModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Styles Gallery</h2>
                    <button class="close-modal" onclick="closeStylesModal()">&times;</button>
                </div>
                
                <div class="style-gallery" style="grid-template-columns: 1fr;">
                    <button class="style-button" onclick="applyStyle('normal')">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 30px; height: 30px; background: #f0f0f0; border-radius: 4px; display: flex; align-items: center; justify-content: center;">
                                <span style="font-weight: normal; font-size: 0.9rem;">A</span>
                            </div>
                            <div>
                                <div style="font-weight: normal;">Normal</div>
                                <div style="font-size: 0.8rem; color: #666;">Teks dokumen biasa</div>
                            </div>
                        </div>
                    </button>
                    
                    <button class="style-button" onclick="applyStyle('heading-1')">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 30px; height: 30px; background: #2B579A; border-radius: 4px; display: flex; align-items: center; justify-content: center;">
                                <span style="font-weight: bold; color: white; font-size: 1.1rem;">H1</span>
                            </div>
                            <div>
                                <div style="font-weight: bold; font-size: 1.2rem; color: #2B579A;">Heading 1</div>
                                <div style="font-size: 0.8rem; color: #666;">Untuk judul bab utama</div>
                            </div>
                        </div>
                    </button>
                    
                    <button class="style-button" onclick="applyStyle('heading-2')">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 30px; height: 30px; background: #4A7BC8; border-radius: 4px; display: flex; align-items: center; justify-content: center;">
                                <span style="font-weight: bold; color: white; font-size: 1rem;">H2</span>
                            </div>
                            <div>
                                <div style="font-weight: bold; font-size: 1.1rem; color: #4A7BC8;">Heading 2</div>
                                <div style="font-size: 0.8rem; color: #666;">Untuk sub-bab</div>
                            </div>
                        </div>
                    </button>
                    
                    <button class="style-button" onclick="applyStyle('heading-3')">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 30px; height: 30px; background: #7BA4D9; border-radius: 4px; display: flex; align-items: center; justify-content: center;">
                                <span style="font-weight: bold; color: white; font-size: 0.9rem;">H3</span>
                            </div>
                            <div>
                                <div style="font-weight: bold; font-size: 1rem; color: #7BA4D9;">Heading 3</div>
                                <div style="font-size: 0.8rem; color: #666;">Untuk sub-sub-bab</div>
                            </div>
                        </div>
                    </button>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #f9f9f9; border-radius: 6px;">
                    <h3 style="margin-bottom: 10px;">Panduan Penggunaan Styles</h3>
                    <ul style="margin-left: 20px;">
                        <li>Pilih teks yang ingin diubah style-nya</li>
                        <li>Klik salah satu style dari gallery di atas</li>
                        <li>Gunakan <strong>Heading 1</strong> untuk judul bab utama</li>
                        <li>Gunakan <strong>Heading 2</strong> untuk sub-bab</li>
                        <li>Gunakan <strong>Heading 3</strong> untuk sub-sub-bab jika diperlukan</li>
                        <li>Gunakan <strong>Normal</strong> untuk teks biasa/paragraf</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Modal Daftar Isi -->
        <div class="modal" id="tocModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Daftar Isi Otomatis</h2>
                    <button class="close-modal" onclick="closeTOCModal()">&times;</button>
                </div>
                
                <div id="tocModalContent">
                    <p>Membuat daftar isi otomatis...</p>
                </div>
                
                <div class="navigation-panel" style="margin-top: 20px;">
                    <button class="nav-button" onclick="updateTOC()">
                        <i class="fas fa-sync"></i> Perbarui Daftar Isi
                    </button>
                    <button class="nav-button primary" onclick="insertTOC()">
                        <i class="fas fa-plus"></i> Sisipkan ke Dokumen
                    </button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Simulator Pembelajaran Daftar Isi Otomatis Microsoft Word - Materi Teknologi Informasi dan Komunikasi</p>
            <p>SMA Negeri 2 Playen - Tahun Pelajaran 2024/2025</p>
        </footer>
    </div>

    <script>
        let selectedElement = null;
        let currentStyle = 'normal';
        
        // Fungsi untuk menerapkan style
        function applyStyle(style) {
            currentStyle = style;
            
            if (selectedElement) {
                // Hapus class style sebelumnya
                selectedElement.classList.remove('heading-1', 'heading-2', 'heading-3', 'normal-text');
                
                // Tambahkan class style yang baru
                if (style !== 'normal') {
                    selectedElement.classList.add(style);
                    selectedElement.setAttribute('data-heading', style.split('-')[1]);
                } else {
                    selectedElement.classList.add('normal-text');
                    selectedElement.setAttribute('data-heading', '0');
                }
                
                // Update informasi dokumen
                updateDocumentInfo();
                
                // Update tampilan daftar isi jika sudah dibuat
                if (document.querySelectorAll('.toc-item').length > 0) {
                    updateTOC();
                }
            } else {
                alert('Pilih teks terlebih dahulu dengan mengklik pada bagian dokumen!');
            }
        }
        
        // Fungsi untuk menghasilkan daftar isi
        function generateTOC() {
            const headings = document.querySelectorAll('[data-heading]');
            const tocPreview = document.getElementById('tocPreview');
            const tocModalContent = document.getElementById('tocModalContent');
            
            // Filter hanya heading (bukan normal text)
            const headingElements = Array.from(headings).filter(el => {
                return el.getAttribute('data-heading') !== '0';
            });
            
            if (headingElements.length === 0) {
                tocPreview.innerHTML = '<p>Tidak ada heading yang ditemukan. Terapkan heading style terlebih dahulu.</p>';
                tocModalContent.innerHTML = '<p>Tidak ada heading yang ditemukan. Terapkan heading style terlebih dahulu.</p>';
                document.getElementById('tocStatus').textContent = 'Gagal - Tidak Ada Heading';
                return;
            }
            
            let tocHTML = '';
            let currentPage = 1;
            
            headingElements.forEach((heading, index) => {
                const level = heading.getAttribute('data-heading');
                const text = heading.textContent;
                
                // Simulasi nomor halaman (dalam implementasi nyata, ini akan dihitung berdasarkan posisi)
                if (index > 0 && index % 3 === 0) {
                    currentPage++;
                }
                
                tocHTML += `
                    <div class="toc-item toc-h${level}" data-index="${index}">
                        <span>${text}</span>
                        <span class="page-number">${currentPage}</span>
                    </div>
                `;
            });
            
            tocPreview.innerHTML = tocHTML;
            tocModalContent.innerHTML = `
                <div style="border: 1px solid #ddd; border-radius: 4px; padding: 15px; background: white;">
                    <div style="text-align: center; font-weight: bold; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px;">DAFTAR ISI</div>
                    ${tocHTML}
                </div>
                <p style="margin-top: 15px; font-size: 0.9rem; color: #666;">Daftar isi telah berhasil dibuat berdasarkan heading yang ada dalam dokumen.</p>
            `;
            
            // Tambahkan event listener untuk item daftar isi
            document.querySelectorAll('.toc-item').forEach(item => {
                item.addEventListener('click', function() {
                    const index = this.getAttribute('data-index');
                    const targetHeading = headingElements[index];
                    
                    // Highlight heading yang dipilih
                    document.querySelectorAll('.heading-1', '.heading-2', '.heading-3').forEach(h => {
                        h.style.backgroundColor = '';
                    });
                    
                    targetHeading.style.backgroundColor = '#e6f3ff';
                    
                    // Scroll ke heading yang dipilih
                    targetHeading.scrollIntoView({ behavior: 'smooth', block: 'center' });
                });
            });
            
            document.getElementById('tocStatus').textContent = 'Aktif - ' + headingElements.length + ' Item';
            
            // Tampilkan pesan sukses
            alert('Daftar isi berhasil dibuat! Klik item daftar isi untuk navigasi cepat.');
        }
        
        // Fungsi untuk memperbarui daftar isi
        function updateTOC() {
            generateTOC();
            alert('Daftar isi telah diperbarui!');
        }
        
        // Fungsi untuk menyisipkan daftar isi ke dokumen
        function insertTOC() {
            const tocModalContent = document.getElementById('tocModalContent');
            const tocHTML = tocModalContent.querySelector('div').outerHTML;
            
            // Cari elemen pertama dalam dokumen
            const firstElement = document.querySelector('#documentPage > div');
            
            // Buat elemen daftar isi baru
            const tocElement = document.createElement('div');
            tocElement.className = 'toc-inserted';
            tocElement.innerHTML = tocHTML;
            
            // Sisipkan sebelum elemen pertama
            document.getElementById('documentPage').insertBefore(tocElement, firstElement);
            
            alert('Daftar isi telah disisipkan ke dokumen!');
            closeTOCModal();
        }
        
        // Fungsi untuk memperbarui informasi dokumen
        function updateDocumentInfo() {
            const heading1Count = document.querySelectorAll('.heading-1').length;
            const heading2Count = document.querySelectorAll('.heading-2').length;
            const heading3Count = document.querySelectorAll('.heading-3').length;
            
            document.getElementById('heading1Count').textContent = heading1Count;
            document.getElementById('heading2Count').textContent = heading2Count;
            document.getElementById('heading3Count').textContent = heading3Count;
        }
        
        // Fungsi untuk menampilkan modal styles
        function showStylesModal() {
            document.getElementById('stylesModal').style.display = 'flex';
        }
        
        // Fungsi untuk menutup modal styles
        function closeStylesModal() {
            document.getElementById('stylesModal').style.display = 'none';
        }
        
        // Fungsi untuk menampilkan modal daftar isi
        function showTOCPanel() {
            generateTOC();
            document.getElementById('tocModal').style.display = 'flex';
        }
        
        // Fungsi untuk menutup modal daftar isi
        function closeTOCModal() {
            document.getElementById('tocModal').style.display = 'none';
        }
        
        // Fungsi untuk menampilkan panel styles di ribbon
        function showStylesPanel() {
            alert('Panel Styles dibuka. Gunakan panel di sidebar untuk mengatur styles.');
        }
        
        // Fungsi untuk menambahkan event listener pada elemen dokumen
        function addEventListeners() {
            const editor = document.getElementById('documentPage');
            const elements = editor.querySelectorAll('div');
            
            elements.forEach(element => {
                element.addEventListener('click', function() {
                    // Hapus seleksi sebelumnya
                    if (selectedElement) {
                        selectedElement.classList.remove('selected');
                    }
                    
                    // Set elemen yang dipilih
                    selectedElement = this;
                    this.classList.add('selected');
                    
                    // Tentukan style saat ini untuk tombol
                    const currentHeading = this.getAttribute('data-heading');
                    
                    if (currentHeading === '0') {
                        currentStyle = 'normal';
                    } else {
                        currentStyle = `heading-${currentHeading}`;
                    }
                });
            });
        }
        
        // Inisialisasi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', function() {
            addEventListeners();
            updateDocumentInfo();
            
            // Set status daftar isi
            document.getElementById('tocStatus').textContent = 'Belum Dibuat';
        });
    </script>
</body>
</html>
